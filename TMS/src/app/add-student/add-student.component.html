<div class="content-area">
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="text-center animate-title mb-0">
        {{ getTranslation("add_new_student") }}
      </h2>
      <button
        class="btn btn-primary animate-button import-btn"
        (click)="openImportModal()"
      >
        <i class="bi bi-upload me-2"></i>
        {{ getTranslation("import_student_list") }}
      </button>
    </div>
    <form
      #studentForm="ngForm"
      (ngSubmit)="onSubmit()"
      class="p-4 bg-white rounded shadow animate-form"
    >
      <div class="row">
        <!-- First Name -->
        <div class="col-md-6 mb-3">
          <label for="firstName" class="form-label">{{
            getTranslation("first_name")
          }}</label>
          <input
            type="text"
            id="firstName"
            name="firstName"
            class="form-control animate-input"
            [placeholder]="getTranslation('enter_first_name')"
            [(ngModel)]="student.firstName"
            required
            pattern="[A-Za-z]+"
          />
          <div
            *ngIf="
              studentForm.controls['firstName']?.invalid &&
              studentForm.controls['firstName']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_first_name") }}
          </div>
        </div>

        <!-- Last Name -->
        <div class="col-md-6 mb-3">
          <label for="lastName" class="form-label">{{
            getTranslation("last_name")
          }}</label>
          <input
            type="text"
            id="lastName"
            name="lastName"
            class="form-control animate-input"
            [placeholder]="getTranslation('enter_last_name')"
            [(ngModel)]="student.lastName"
            required
            pattern="[A-Za-z]+"
          />
          <div
            *ngIf="
              studentForm.controls['lastName']?.invalid &&
              studentForm.controls['lastName']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_last_name") }}
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Date of Birth -->
        <div class="col-md-6 mb-3">
          <label for="dateOfBirth" class="form-label">{{
            getTranslation("date_of_birth")
          }}</label>
          <input
            type="date"
            id="dateOfBirth"
            name="dateOfBirth"
            class="form-control animate-input"
            [(ngModel)]="student.dateOfBirth"
            required
          />
          <div
            *ngIf="
              studentForm.controls['dateOfBirth']?.invalid &&
              studentForm.controls['dateOfBirth']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_date_of_birth") }}
          </div>
        </div>

        <!-- Gender -->
        <div class="col-md-6 mb-3">
          <label for="gender" class="form-label">{{
            getTranslation("gender")
          }}</label>
          <select
            id="gender"
            name="gender"
            class="form-select animate-input"
            [(ngModel)]="student.gender"
            required
          >
            <option value="" disabled selected>
              {{ getTranslation("select_gender") }}
            </option>
            <option value="Male">{{ getTranslation("male") }}</option>
            <option value="Female">{{ getTranslation("female") }}</option>
            <option value="Other">{{ getTranslation("other") }}</option>
          </select>
          <div
            *ngIf="
              studentForm.controls['gender']?.invalid &&
              studentForm.controls['gender']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_gender") }}
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Contact Number -->
        <div class="col-md-6 mb-3">
          <label for="contactNumber" class="form-label">{{
            getTranslation("contact_number")
          }}</label>
          <input
            type="tel"
            id="contactNumber"
            name="contactNumber"
            class="form-control animate-input"
            [placeholder]="getTranslation('enter_contact_number')"
            [(ngModel)]="student.contactNumber"
            required
            pattern="[0-9]{10}"
          />
          <div
            *ngIf="
              studentForm.controls['contactNumber']?.invalid &&
              studentForm.controls['contactNumber']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_contact_number") }}
          </div>
        </div>

        <!-- Email -->
        <div class="col-md-6 mb-3">
          <label for="email" class="form-label">{{
            getTranslation("email")
          }}</label>
          <input
            type="email"
            id="email"
            name="email"
            class="form-control animate-input"
            [placeholder]="getTranslation('enter_email')"
            [(ngModel)]="student.email"
            required
            email
          />
          <div
            *ngIf="
              studentForm.controls['email']?.invalid &&
              studentForm.controls['email']?.touched
            "
            class="text-danger animate-error"
          >
            {{ getTranslation("invalid_email") }}
          </div>
        </div>
      </div>

      <!-- Address -->
      <div class="mb-3">
        <label for="address" class="form-label">{{
          getTranslation("address")
        }}</label>
        <input
          id="address"
          name="address"
          class="form-control animate-input"
          [placeholder]="getTranslation('enter_address')"
          [(ngModel)]="student.address"
          required
        />
        <div
          *ngIf="
            studentForm.controls['address']?.invalid &&
            studentForm.controls['address']?.touched
          "
          class="text-danger animate-error"
        >
          {{ getTranslation("invalid_address") }}
        </div>
      </div>

      <!-- Enrollment Date -->
      <div class="mb-3">
        <label for="enrollmentDate" class="form-label">{{
          getTranslation("admission_date")
        }}</label>
        <input
          type="date"
          id="enrollmentDate"
          name="enrollmentDate"
          class="form-control animate-input"
          [(ngModel)]="student.enrollmentDate"
          required
        />
        <div
          *ngIf="
            studentForm.controls['enrollmentDate']?.invalid &&
            studentForm.controls['enrollmentDate']?.touched
          "
          class="text-danger animate-error"
        >
          {{ getTranslation("invalid_enrollment_date") }}
        </div>
      </div>

      <!-- Submit Button -->
      <div class="text-center">
        <button
          type="submit"
          class="btn btn-primary animate-button"
          [disabled]="studentForm.invalid"
        >
          {{ getTranslation("add_student") }}
        </button>
      </div>
    </form>

    <!-- Custom Import Modal -->
    <div class="custom-modal" *ngIf="isImportModalOpen">
      <div class="modal-overlay" (click)="closeImportModal()"></div>
      <div class="modal-content animate-modal">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-file-earmark-arrow-up me-2"></i>
            {{ getTranslation("import_student_list") }}
          </h5>
          <button
            type="button"
            class="close-btn"
            (click)="closeImportModal()"
            aria-label="Close"
          >
            <i class="bi bi-x-lg"></i>
          </button>
        </div>
        <div class="modal-body">
          <div
            class="drag-drop-area"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
            [ngClass]="{ 'drag-over': isDragging }"
          >
            <i class="bi bi-cloud-upload display-4 text-muted mb-3"></i>
            <p class="mb-2">{{ getTranslation("drag_drop_csv") }}</p>
            <input
              type="file"
              id="csvFile"
              accept=".csv"
              class="d-none"
              (change)="onFileSelected($event)"
            />
            <label
              style="color: white"
              for="csvFile"
              class="btn btn-outline-primary animate-button"
            >
              <i class="bi bi-folder2-open me-2"></i>
              {{ getTranslation("choose_file") }}
            </label>
            <p *ngIf="selectedFile" class="mt-3 text-success">
              <i class="bi bi-check-circle me-2"></i>
              {{ selectedFile.name }}
            </p>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary animate-button"
            (click)="closeImportModal()"
          >
            <i class="bi bi-x-circle me-2"></i> {{ getTranslation("cancel") }}
          </button>
          <button
            type="button"
            class="btn btn-primary animate-button"
            (click)="importCsv()"
            [disabled]="!selectedFile"
          >
            <i class="bi bi-file-earmark-check me-2"></i>
            {{ getTranslation("import") }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
